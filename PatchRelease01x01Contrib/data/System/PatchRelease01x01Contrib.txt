%META:TOPICINFO{author="ProjectContributor" comment="" date="1446264082" format="1.1"  version="1"}%
<!--
One line description, required for extensions repository catalog.
   * Set SHORTDESCRIPTION = %$SHORTDESCRIPTION%
-->
---+!! PatchRelease01x01Contrib

%SHORTDESCRIPTION%

This extension installs fixes for the following critical issues:

   * ==Item11267==: Fixes Item12225 - extension using new Version strings break configure. Applies to Foswiki 1.1.5 and earlier.
   * ==Item12285==: Security fixes related to the Maketext vulnerability.  Applies to Foswiki 1.1.6 and earlier.
   * ==Item12391==: More Maketext validations - Security issue applies to Foswiki 1.1.7 and earlier.
   * ==Item12414==: Newer versions of =File::Temp= cause die in =Foswiki::Sandbox::sysCommand()= (Applies to Foswiki-1.1.6, Foswiki-1.1.7 and Foswiki-1.1.8 )
   * ==Item12616==: Warnings and Errors due to newer versions of perl. (Fixed in Foswiki 1.1.9)
   * ==Item12849==: Add ACL * wildcard for backwards compatibilty with Foswiki 2.0.  Applies to all Foswiki 1.1 versions.
   * ==Item13775==: Warnings due to CGI::param called in list context.
   * ==Item13777==: Backport changes in URLPARAM and SEARCH for extension compatibility.

%TOC%

---++ Usage

This extension allows you to "hotfix" urgent issues on your Foswiki system.  It has been tested on Foswiki 1.1.0 and beyond.  It does not work on Foswiki 1.0.x.

When this extension is installed, it adds some required libraries to your Foswiki system, and includes a plugin to display an inventory of patches on the system.  This extension does not ship with any patches.
this extension will be identified as a dependency of the actual patch, so that necessary infrastructure is installed.

Patches are only applied if the target file is an _exact_ match to the original file.  There is no attempt to do "fuzzy" patching.

There is no "dependency" between patches.  Patches are installed in order of their patch file name. 

Patches will be mapped from the default Foswiki filename to the directory location used on the target system.

Before any file is patched, a backup is copied to =working/configure/backup/&lt;Itemxxxx-nnn-YYYMMDD-HHMMSS&gt;=.  If archive tools are found on the system, a zip or tar archive is created of the backup.

%INCLUDE{"PatchFoswikiContribPlugin" section="patchreport"}%

---++ Installation

Patches are applied during the =POSTINSTALL= exit, and removed in the =PREUNINSTALL= exit.  You must install this extension
using the "Extension Installer" to get automatic patching. If this extension
is installed by direct unzip / tar -x, or using pseudo_install.pl, patches will not be applied and will
have to be manually patched using the =patch= tool.

---+++ Manual installation

=unzip= or =tar -x= the extension archive.  It can be extracted into the root
of the foswiki installation if the directory paths use the default location.
The structure of a typical patch:
<verbatim>
|-- data
|   |-- System
|       |-- PatchRelease01x01Contrib.txt
|-- lib
|   |-- Foswiki
|       |-- Contrib
|           |-- PatchItem13775Contrib.pm
|           |-- PatchRelease01x01Contrib
|               |-- DEPENDENCIES
|-- working
    |-- configure
        |-- patch
            |-- Item11267-110.patch    (A unique version of each patch for each applicable Foswiki version.)
            |-- Item11267-111.patch
            |-- Item11267-....patch
            |-- Item12616-118.patch
            |-- Item13775-118.patch
            |-- Item13775-119.patch
            |-- Item13777-118.patch
            |-- Item13777-119.patch
</verbatim>

The following patch files are included:
| *Patch file* | *Modifies* | *Applies to Releases:* |
|| Item11267:  New extension VERSION strings will crash configure ||
| Item11267-001.patch | | |
| Item11267-002.patch | | |
|| Item12285: Maketext vulnerability ||
| Item12285-112.patch | | |
| Item12285-116.patch | | |
|| Item12391: ||
| Item12391-112.patch | | |
| Item12391-116.patch | | |
| Item12391-117.patch | | |
| Item12414-118.patch | | |
| Item12616-118.patch | | |
| Item12849-110.patch | | |
| Item12849-113.patch | | |
| Item12849-114.patch | | |
| Item12849-115.patch | | |
| Item12849-119.patch | | |
| Item13775: CGI removed the -any pragma. Patches: <br/>\
<ul><li> =bin/configure= <br/>\
<li> =lib/Foswiki/Configure/Type.pm= <br/>\
<li> =lib/Foswiki/Engine/CGI.pm= <br/>\
<li> =lib/Foswiki/Plugins/CommentPlugin/Comment.pm= <br/>\
<li> =lib/Foswiki/Plugins/WysiwygPlugin/Handlers.pm= <br/>\
<li> =lib/Foswiki/Contrib/MailerContrib.pm= <br/>\
<li> =lib/Foswiki/Plugins/WysiwygPlugin/TML2HTML.pm= </ul> ||
| Item13775-110.patch | 1.1.0 |
| Item13775-111.patch | 1.1.1 |
| Item13775-112.patch | 1.1.2 |
| Item13775-118.patch | 1.1.8 |
| Item13775-119.patch | 1.1.9 |
|| Item13777: Encode URLPARAM to prevent xss ||
| Item13777-118.patch | =lib/Foswiki/Macros/URLPARAM.pm= =lib/Foswiki/Search.pm= =data/System/WebSearch.txt= | 1.1.8 |
| Item13777-119.patch | =lib/Foswiki/Macros/URLPARAM.pm= =lib/Foswiki/Search.pm= =data/System/WebSearch.txt= | 1.1.9 |


The files in the =working/configure/patch= directory are the actual patches.
If a collection of related files is patched in a single file, they can be manually applied by
changing to the root of the install and running:
<verbatim>
patch -p0 < working/configure/patch/Item54321-001.patch
</verbatim>

By a "collection of related files",  =Item12345-001.patch= might contain
patches for =lib/Foswiki.pm= and =lib/Foswiki/Render.pm=.   These could be
appplied directly.   But if =Item12345-002.patch= contained different versions
of patches for the same file,   ex.  =lib/Foswiki.pm= for 1.1.9, and
=lib/Foswiki.pm= for 1.1.8, then the file would have to be split apart in
order to apply it manually.

---++ Info

|  Author: | GeorgeClark |
|  Copyright &copy;: | 2012-2015 Foswiki Contributors |
|  License: | GPL ([[http://www.gnu.org/copyleft/gpl.html][GNU General Public License]]) |
|  Dependencies: | %$DEPENDENCIES% |
|  Version: | %$VERSION% |
|  Change History: | <!-- versions below in reverse order -->&nbsp; |
|  1.0 (02 Oct 2015) | Initial version |
|  Home: | http://foswiki.org/Extensions/%TOPIC% |
|  Support: | http://foswiki.org/Support/%TOPIC% |


